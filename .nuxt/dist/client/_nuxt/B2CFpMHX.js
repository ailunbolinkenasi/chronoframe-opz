import{i as Ie,p as ze,F as re,g as ae,f as He,h as be,r as C,j as x,k as ce,l as Fe,m as je,n as Ue,q as W,s as We,v as _e,x as Ge,y as te,z as we,A as X,B as fe,C as A,D as xe,E as ne,G as Ke,H as se,I as Ve,J,K as Ze,L as Xe,M as L,o as P,w as g,N as F,O as s,P as pe,Q as Ye,R as T,T as Je,S as ke,U as Qe,V as et,c as q,b as h,W as tt,X as nt,Y as rt,Z as ot,$ as at,a0 as Z,a as _,a1 as oe,t as B,a2 as Pe,a3 as Ce,a4 as Oe,a5 as le,e as Se,a6 as me,a7 as Ee,a8 as De,a9 as st,u as it,aa as lt,ab as ut,ac as dt,ad as ct,ae as ft,af as pt,ag as mt}from"./Do4Ulm4h.js";import{o as vt,f as ge,s as ht,a as yt,b as gt,h as bt,l as _t,u as wt,c as xt}from"./zoi52lI1.js";import{_ as $e}from"./BC21tflR.js";function ve(n,t){const e=typeof n=="string"&&!t?`${n}Context`:t,o=Symbol(e);return[a=>{const i=Ie(o,a);if(i||i===null)return i;throw new Error(`Injection \`${o.toString()}\` not found. Component must be used within ${Array.isArray(n)?`one of the following components: ${n.join(", ")}`:`\`${n}\``}`)},a=>(ze(o,a),a)]}function qe(n,t,e){const o=e.originalEvent.target,l=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:e});t&&o.addEventListener(n,t,{once:!0}),o.dispatchEvent(l)}function kt(n){return n==null}function he(n){return n?n.flatMap(t=>t.type===re?he(t.children):[t]):[]}function Pt(n){const t=ae(),e=t?.type.emits,o={};return e?.length||console.warn(`No emitted event found. Please check component: ${t?.type.__name}`),e?.forEach(l=>{o[He(be(l))]=(...r)=>n(l,...r)}),o}function V(){const n=ae(),t=C(),e=x(()=>["#text","#comment"].includes(t.value?.$el.nodeName)?t.value?.$el.nextElementSibling:ce(t)),o=Object.assign({},n.exposed),l={};for(const a in n.props)Object.defineProperty(l,a,{enumerable:!0,configurable:!0,get:()=>n.props[a]});if(Object.keys(o).length>0)for(const a in o)Object.defineProperty(l,a,{enumerable:!0,configurable:!0,get:()=>o[a]});Object.defineProperty(l,"$el",{enumerable:!0,configurable:!0,get:()=>n.vnode.el}),n.exposed=l;function r(a){if(t.value=a,!!a&&(Object.defineProperty(l,"$el",{enumerable:!0,configurable:!0,get:()=>a instanceof Element?a:a.$el}),!(a instanceof Element)&&!Object.hasOwn(a,"$el"))){const i=a.$.exposed,u=Object.assign({},l);for(const d in i)Object.defineProperty(u,d,{enumerable:!0,configurable:!0,get:()=>i[d]});n.exposed=u}}return{forwardRef:r,currentRef:t,currentElement:e}}function Ae(n){const t=ae(),e=Object.keys(t?.type.props??{}).reduce((l,r)=>{const a=(t?.type.props[r]).default;return a!==void 0&&(l[r]=a),l},{}),o=Fe(n);return x(()=>{const l={},r=t?.vnode.props??{};return Object.keys(r).forEach(a=>{l[be(a)]=r[a]}),Object.keys({...e,...l}).reduce((a,i)=>(o.value[i]!==void 0&&(a[i]=o.value[i]),a),{})})}function Ct(n,t){const e=Ae(n),o=t?Pt(t):{};return x(()=>({...e.value,...o}))}function Ot(n,t){const e=je(!1,300);Ue(()=>{e.value=!1});const o=C(null),l=We();function r(){o.value=null,e.value=!1}function a(i,u){const d=i.currentTarget,c={x:i.clientX,y:i.clientY},v=St(c,d.getBoundingClientRect()),b=Et(c,v),p=Dt(u.getBoundingClientRect()),f=qt([...b,...p]);o.value=f,e.value=!0}return W(i=>{if(n.value&&t.value){const u=c=>a(c,t.value),d=c=>a(c,n.value);n.value.addEventListener("pointerleave",u),t.value.addEventListener("pointerleave",d),i(()=>{n.value?.removeEventListener("pointerleave",u),t.value?.removeEventListener("pointerleave",d)})}}),W(i=>{if(o.value){const u=d=>{if(!o.value||!(d.target instanceof Element))return;const c=d.target,v={x:d.clientX,y:d.clientY},b=n.value?.contains(c)||t.value?.contains(c),p=!$t(v,o.value),f=!!c.closest("[data-grace-area-trigger]");b?r():(p||f)&&(r(),l.trigger())};n.value?.ownerDocument.addEventListener("pointermove",u),i(()=>n.value?.ownerDocument.removeEventListener("pointermove",u))}}),{isPointerInTransit:e,onPointerExit:l.on}}function St(n,t){const e=Math.abs(t.top-n.y),o=Math.abs(t.bottom-n.y),l=Math.abs(t.right-n.x),r=Math.abs(t.left-n.x);switch(Math.min(e,o,l,r)){case r:return"left";case l:return"right";case e:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function Et(n,t,e=5){const o=[];switch(t){case"top":o.push({x:n.x-e,y:n.y+e},{x:n.x+e,y:n.y+e});break;case"bottom":o.push({x:n.x-e,y:n.y-e},{x:n.x+e,y:n.y-e});break;case"left":o.push({x:n.x+e,y:n.y-e},{x:n.x+e,y:n.y+e});break;case"right":o.push({x:n.x-e,y:n.y-e},{x:n.x-e,y:n.y+e});break}return o}function Dt(n){const{top:t,right:e,bottom:o,left:l}=n;return[{x:l,y:t},{x:e,y:t},{x:e,y:o},{x:l,y:o}]}function $t(n,t){const{x:e,y:o}=n;let l=!1;for(let r=0,a=t.length-1;r<t.length;a=r++){const i=t[r].x,u=t[r].y,d=t[a].x,c=t[a].y;u>o!=c>o&&e<(d-i)*(o-u)/(c-u)+i&&(l=!l)}return l}function qt(n){const t=n.slice();return t.sort((e,o)=>e.x<o.x?-1:e.x>o.x?1:e.y<o.y?-1:e.y>o.y?1:0),At(t)}function At(n){if(n.length<=1)return n.slice();const t=[];for(let o=0;o<n.length;o++){const l=n[o];for(;t.length>=2;){const r=t[t.length-1],a=t[t.length-2];if((r.x-a.x)*(l.y-a.y)>=(r.y-a.y)*(l.x-a.x))t.pop();else break}t.push(l)}t.pop();const e=[];for(let o=n.length-1;o>=0;o--){const l=n[o];for(;e.length>=2;){const r=e[e.length-1],a=e[e.length-2];if((r.x-a.x)*(l.y-a.y)>=(r.y-a.y)*(l.x-a.x))e.pop();else break}e.push(l)}return e.pop(),t.length===1&&e.length===1&&t[0].x===e[0].x&&t[0].y===e[0].y?t:t.concat(e)}function Mt(n){const t=C(),e=x(()=>t.value?.width??0),o=x(()=>t.value?.height??0);return _e(()=>{const l=ce(n);if(l){t.value={width:l.offsetWidth,height:l.offsetHeight};const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let u,d;if("borderBoxSize"in i){const c=i.borderBoxSize,v=Array.isArray(c)?c[0]:c;u=v.inlineSize,d=v.blockSize}else u=l.offsetWidth,d=l.offsetHeight;t.value={width:u,height:d}});return r.observe(l,{box:"border-box"}),()=>r.unobserve(l)}else t.value=void 0}),{width:e,height:o}}function Tt(n,t){const e=C(n);function o(r){return t[e.value][r]??e.value}return{state:e,dispatch:r=>{e.value=o(r)}}}function Lt(n,t){const e=C({}),o=C("none"),l=C(n),r=n.value?"mounted":"unmounted";let a;const i=t.value?.ownerDocument.defaultView??Ge,{state:u,dispatch:d}=Tt(r,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),c=k=>{if(fe){const S=new CustomEvent(k,{bubbles:!1,cancelable:!1});t.value?.dispatchEvent(S)}};te(n,async(k,S)=>{const O=S!==k;if(await X(),O){const z=o.value,y=ee(t.value);k?(d("MOUNT"),c("enter"),y==="none"&&c("after-enter")):y==="none"||y==="undefined"||e.value?.display==="none"?(d("UNMOUNT"),c("leave"),c("after-leave")):S&&z!==y?(d("ANIMATION_OUT"),c("leave")):(d("UNMOUNT"),c("after-leave"))}},{immediate:!0});const v=k=>{const S=ee(t.value),O=S.includes(CSS.escape(k.animationName)),z=u.value==="mounted"?"enter":"leave";if(k.target===t.value&&O&&(c(`after-${z}`),d("ANIMATION_END"),!l.value)){const y=t.value.style.animationFillMode;t.value.style.animationFillMode="forwards",a=i?.setTimeout(()=>{t.value?.style.animationFillMode==="forwards"&&(t.value.style.animationFillMode=y)})}k.target===t.value&&S==="none"&&d("ANIMATION_END")},b=k=>{k.target===t.value&&(o.value=ee(t.value))},p=te(t,(k,S)=>{k?(e.value=getComputedStyle(k),k.addEventListener("animationstart",b),k.addEventListener("animationcancel",v),k.addEventListener("animationend",v)):(d("ANIMATION_END"),a!==void 0&&i?.clearTimeout(a),S?.removeEventListener("animationstart",b),S?.removeEventListener("animationcancel",v),S?.removeEventListener("animationend",v))},{immediate:!0}),f=te(u,()=>{const k=ee(t.value);o.value=u.value==="mounted"?k:"none"});return we(()=>{p(),f()}),{isPresent:x(()=>["mounted","unmountSuspended"].includes(u.value))}}function ee(n){return n&&getComputedStyle(n).animationName||"none"}var Bt=A({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(n,{slots:t,expose:e}){const{present:o,forceMount:l}=xe(n),r=C(),{isPresent:a}=Lt(o,r);e({present:a});let i=t.default({present:a.value});i=he(i||[]);const u=ae();if(i&&i?.length>1){const d=u?.parent?.type.name?`<${u.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${d}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(c=>`  - ${c}`).join(`
`)].join(`
`))}return()=>l.value||o.value||a.value?ne(t.default({present:a.value})[0],{ref:d=>{const c=ce(d);return typeof c?.hasAttribute>"u"||(c?.hasAttribute("data-reka-popper-content-wrapper")?r.value=c.firstElementChild:r.value=c),c}}):null}});const Nt=A({name:"PrimitiveSlot",inheritAttrs:!1,setup(n,{attrs:t,slots:e}){return()=>{if(!e.default)return null;const o=he(e.default()),l=o.findIndex(u=>u.type!==Ke);if(l===-1)return o;const r=o[l];delete r.props?.ref;const a=r.props?se(t,r.props):t,i=Ve({...r,props:{}},a);return o.length===1?i:(o[l]=i,o)}}}),Rt=["area","img","input"],ie=A({name:"Primitive",inheritAttrs:!1,props:{asChild:{type:Boolean,default:!1},as:{type:[String,Object],default:"div"}},setup(n,{attrs:t,slots:e}){const o=n.asChild?"template":n.as;return typeof o=="string"&&Rt.includes(o)?()=>ne(o,t):o!=="template"?()=>ne(n.as,t,{default:e.default}):()=>ne(Nt,t,{default:e.default})}}),It="dismissableLayer.pointerDownOutside",zt="dismissableLayer.focusOutside";function Me(n,t){const e=t.closest("[data-dismissable-layer]"),o=n.dataset.dismissableLayer===""?n:n.querySelector("[data-dismissable-layer]"),l=Array.from(n.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(e&&(o===e||l.indexOf(o)<l.indexOf(e)))}function Ht(n,t,e=!0){const o=t?.value?.ownerDocument??globalThis?.document,l=C(!1),r=C(()=>{});return W(a=>{if(!fe||!J(e))return;const i=async d=>{const c=d.target;if(!(!t?.value||!c)){if(Me(t.value,c)){l.value=!1;return}if(d.target&&!l.value){let b=function(){qe(It,n,v)};const v={originalEvent:d};d.pointerType==="touch"?(o.removeEventListener("click",r.value),r.value=b,o.addEventListener("click",r.value,{once:!0})):b()}else o.removeEventListener("click",r.value);l.value=!1}},u=window.setTimeout(()=>{o.addEventListener("pointerdown",i)},0);a(()=>{window.clearTimeout(u),o.removeEventListener("pointerdown",i),o.removeEventListener("click",r.value)})}),{onPointerDownCapture:()=>{J(e)&&(l.value=!0)}}}function Ft(n,t,e=!0){const o=t?.value?.ownerDocument??globalThis?.document,l=C(!1);return W(r=>{if(!fe||!J(e))return;const a=async i=>{if(!t?.value)return;await X(),await X();const u=i.target;!t.value||!u||Me(t.value,u)||i.target&&!l.value&&qe(zt,n,{originalEvent:i})};o.addEventListener("focusin",a),r(()=>o.removeEventListener("focusin",a))}),{onFocusCapture:()=>{J(e)&&(l.value=!0)},onBlurCapture:()=>{J(e)&&(l.value=!1)}}}const R=Ze({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,originalBodyPointerEvents:void 0,branches:new Set});var jt=A({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(n,{emit:t}){const e=n,o=t,{forwardRef:l,currentElement:r}=V(),a=x(()=>r.value?.ownerDocument??globalThis.document),i=x(()=>R.layersRoot),u=x(()=>r.value?Array.from(i.value).indexOf(r.value):-1),d=x(()=>R.layersWithOutsidePointerEventsDisabled.size>0),c=x(()=>{const p=Array.from(i.value),[f]=[...R.layersWithOutsidePointerEventsDisabled].slice(-1),w=p.indexOf(f);return u.value>=w}),v=Ht(async p=>{const f=[...R.branches].some(w=>w?.contains(p.target));!c.value||f||(o("pointerDownOutside",p),o("interactOutside",p),await X(),p.defaultPrevented||o("dismiss"))},r),b=Ft(p=>{[...R.branches].some(w=>w?.contains(p.target))||(o("focusOutside",p),o("interactOutside",p),p.defaultPrevented||o("dismiss"))},r);return Xe("Escape",p=>{u.value===i.value.size-1&&(o("escapeKeyDown",p),p.defaultPrevented||o("dismiss"))}),W(p=>{r.value&&(e.disableOutsidePointerEvents&&(R.layersWithOutsidePointerEventsDisabled.size===0&&(R.originalBodyPointerEvents=a.value.body.style.pointerEvents,a.value.body.style.pointerEvents="none"),R.layersWithOutsidePointerEventsDisabled.add(r.value)),i.value.add(r.value),p(()=>{e.disableOutsidePointerEvents&&R.layersWithOutsidePointerEventsDisabled.size===1&&!kt(R.originalBodyPointerEvents)&&(a.value.body.style.pointerEvents=R.originalBodyPointerEvents)}))}),W(p=>{p(()=>{r.value&&(i.value.delete(r.value),R.layersWithOutsidePointerEventsDisabled.delete(r.value))})}),(p,f)=>(P(),L(s(ie),{ref:s(l),"as-child":p.asChild,as:p.as,"data-dismissable-layer":"",style:pe({pointerEvents:d.value?c.value?"auto":"none":void 0}),onFocusCapture:s(b).onFocusCapture,onBlurCapture:s(b).onBlurCapture,onPointerdownCapture:s(v).onPointerDownCapture},{default:g(()=>[F(p.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),Ut=jt,Wt=A({__name:"Teleport",props:{to:{type:null,required:!1,default:"body"},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(n){const t=Ye();return(e,o)=>s(t)||e.forceMount?(P(),L(Je,{key:0,to:e.to,disabled:e.disabled,defer:e.defer},[F(e.$slots,"default")],8,["to","disabled","defer"])):T("v-if",!0)}}),Gt=Wt;const[Te,Kt]=ve("PopperRoot");var Vt=A({inheritAttrs:!1,__name:"PopperRoot",setup(n){const t=C();return Kt({anchor:t,onAnchorChange:e=>t.value=e}),(e,o)=>F(e.$slots,"default")}}),Zt=Vt,Xt=A({__name:"PopperAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(n){const t=n,{forwardRef:e,currentElement:o}=V(),l=Te();return ke(()=>{l.onAnchorChange(t.reference??o.value)}),(r,a)=>(P(),L(s(ie),{ref:s(e),as:r.as,"as-child":r.asChild},{default:g(()=>[F(r.$slots,"default")]),_:3},8,["as","as-child"]))}}),Yt=Xt;function Jt(n){return n!==null}function Qt(n){return{name:"transformOrigin",options:n,fn(t){const{placement:e,rects:o,middlewareData:l}=t,a=l.arrow?.centerOffset!==0,i=a?0:n.arrowWidth,u=a?0:n.arrowHeight,[d,c]=ue(e),v={start:"0%",center:"50%",end:"100%"}[c],b=(l.arrow?.x??0)+i/2,p=(l.arrow?.y??0)+u/2;let f="",w="";return d==="bottom"?(f=a?v:`${b}px`,w=`${-u}px`):d==="top"?(f=a?v:`${b}px`,w=`${o.floating.height+u}px`):d==="right"?(f=`${-u}px`,w=a?v:`${p}px`):d==="left"&&(f=`${o.floating.width+u}px`,w=a?v:`${p}px`),{data:{x:f,y:w}}}}}function ue(n){const[t,e="center"]=n.split("-");return[t,e]}const en={side:"bottom",sideOffset:0,sideFlip:!0,align:"center",alignOffset:0,alignFlip:!0,arrowPadding:0,avoidCollisions:!0,collisionBoundary:()=>[],collisionPadding:0,sticky:"partial",hideWhenDetached:!1,positionStrategy:"fixed",updatePositionStrategy:"optimized",prioritizePosition:!1},[ar,tn]=ve("PopperContent");var nn=A({inheritAttrs:!1,__name:"PopperContent",props:Qe({side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...en}),emits:["placed"],setup(n,{emit:t}){const e=n,o=t,l=Te(),{forwardRef:r,currentElement:a}=V(),i=C(),u=C(),{width:d,height:c}=Mt(u),v=x(()=>e.side+(e.align!=="center"?`-${e.align}`:"")),b=x(()=>typeof e.collisionPadding=="number"?e.collisionPadding:{top:0,right:0,bottom:0,left:0,...e.collisionPadding}),p=x(()=>Array.isArray(e.collisionBoundary)?e.collisionBoundary:[e.collisionBoundary]),f=x(()=>({padding:b.value,boundary:p.value.filter(Jt),altBoundary:p.value.length>0})),w=x(()=>({mainAxis:e.sideFlip,crossAxis:e.alignFlip})),k=et(()=>[vt({mainAxis:e.sideOffset+c.value,alignmentAxis:e.alignOffset}),e.prioritizePosition&&e.avoidCollisions&&ge({...f.value,...w.value}),e.avoidCollisions&&ht({mainAxis:!0,crossAxis:!!e.prioritizePosition,limiter:e.sticky==="partial"?_t():void 0,...f.value}),!e.prioritizePosition&&e.avoidCollisions&&ge({...f.value,...w.value}),yt({...f.value,apply:({elements:M,rects:$,availableWidth:K,availableHeight:H})=>{const{width:N,height:Y}=$.reference,Q=M.floating.style;Q.setProperty("--reka-popper-available-width",`${K}px`),Q.setProperty("--reka-popper-available-height",`${H}px`),Q.setProperty("--reka-popper-anchor-width",`${N}px`),Q.setProperty("--reka-popper-anchor-height",`${Y}px`)}}),u.value&&gt({element:u.value,padding:e.arrowPadding}),Qt({arrowWidth:d.value,arrowHeight:c.value}),e.hideWhenDetached&&bt({strategy:"referenceHidden",...f.value})]),S=x(()=>e.reference??l.anchor.value),{floatingStyles:O,placement:z,isPositioned:y,middlewareData:m}=wt(S,i,{strategy:e.positionStrategy,placement:v,whileElementsMounted:(...M)=>xt(...M,{layoutShift:!e.disableUpdateOnLayoutShift,animationFrame:e.updatePositionStrategy==="always"}),middleware:k}),E=x(()=>ue(z.value)[0]),D=x(()=>ue(z.value)[1]);ke(()=>{y.value&&o("placed")});const I=x(()=>m.value.arrow?.centerOffset!==0),j=C("");W(()=>{a.value&&(j.value=window.getComputedStyle(a.value).zIndex)});const U=x(()=>m.value.arrow?.x??0),G=x(()=>m.value.arrow?.y??0);return tn({placedSide:E,onArrowChange:M=>u.value=M,arrowX:U,arrowY:G,shouldHideArrow:I}),(M,$)=>(P(),q("div",{ref_key:"floatingRef",ref:i,"data-reka-popper-content-wrapper":"",style:pe({...s(O),transform:s(y)?s(O).transform:"translate(0, -200%)",minWidth:"max-content",zIndex:j.value,"--reka-popper-transform-origin":[s(m).transformOrigin?.x,s(m).transformOrigin?.y].join(" "),...s(m).hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}})},[h(s(ie),se({ref:s(r)},M.$attrs,{"as-child":e.asChild,as:M.as,"data-side":E.value,"data-align":D.value,style:{animation:s(y)?void 0:"none"}}),{default:g(()=>[F(M.$slots,"default")]),_:3},16,["as-child","as","data-side","data-align","style"])],4))}}),rn=nn;const[ye,on]=ve("HoverCardRoot");var an=A({__name:"HoverCardRoot",props:{defaultOpen:{type:Boolean,required:!1,default:!1},open:{type:Boolean,required:!1,default:void 0},openDelay:{type:Number,required:!1,default:700},closeDelay:{type:Number,required:!1,default:300}},emits:["update:open"],setup(n,{emit:t}){const e=n,o=t,{openDelay:l,closeDelay:r}=xe(e);V();const a=tt(e,"open",o,{defaultValue:e.defaultOpen,passive:e.open===void 0}),i=C(0),u=C(0),d=C(!1),c=C(!1),v=C(!1),b=C();function p(){clearTimeout(u.value),i.value=window.setTimeout(()=>a.value=!0,l.value)}function f(){clearTimeout(i.value),!d.value&&!c.value&&(u.value=window.setTimeout(()=>a.value=!1,r.value))}function w(){a.value=!1}return on({open:a,onOpenChange(k){a.value=k},onOpen:p,onClose:f,onDismiss:w,hasSelectionRef:d,isPointerDownOnContentRef:c,isPointerInTransitRef:v,triggerElement:b}),(k,S)=>(P(),L(s(Zt),null,{default:g(()=>[F(k.$slots,"default",{open:s(a)})]),_:3}))}}),Le=an;function de(n){return t=>t.pointerType==="touch"?void 0:n()}function sn(n){const t=[],e=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;e.nextNode();)t.push(e.currentNode);return t}var ln=A({__name:"HoverCardContentImpl",props:{side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(n,{emit:t}){const e=n,o=t,l=Ae(e),{forwardRef:r,currentElement:a}=V(),i=ye(),{isPointerInTransit:u,onPointerExit:d}=Ot(i.triggerElement,a);nt(i.isPointerInTransitRef,u,{direction:"rtl"}),d(()=>{i.onClose()});const c=C(!1);let v;W(p=>{if(c.value){const f=document.body;v=f.style.userSelect||f.style.webkitUserSelect,f.style.userSelect="none",f.style.webkitUserSelect="none",p(()=>{f.style.userSelect=v,f.style.webkitUserSelect=v})}});function b(){c.value=!1,i.isPointerDownOnContentRef.value=!1,X(()=>{document.getSelection()?.toString()!==""&&(i.hasSelectionRef.value=!0)})}return _e(()=>{a.value&&(document.addEventListener("pointerup",b),sn(a.value).forEach(f=>f.setAttribute("tabindex","-1")))}),we(()=>{document.removeEventListener("pointerup",b),i.hasSelectionRef.value=!1,i.isPointerDownOnContentRef.value=!1}),(p,f)=>(P(),L(s(Ut),{"as-child":"","disable-outside-pointer-events":!1,onEscapeKeyDown:f[1]||(f[1]=w=>o("escapeKeyDown",w)),onPointerDownOutside:f[2]||(f[2]=w=>o("pointerDownOutside",w)),onFocusOutside:f[3]||(f[3]=rt(w=>o("focusOutside",w),["prevent"])),onDismiss:s(i).onDismiss},{default:g(()=>[h(s(rn),se({...s(l),...p.$attrs},{ref:s(r),"data-state":s(i).open.value?"open":"closed",style:{userSelect:c.value?"text":void 0,WebkitUserSelect:c.value?"text":void 0,"--reka-hover-card-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-hover-card-content-available-width":"var(--reka-popper-available-width)","--reka-hover-card-content-available-height":"var(--reka-popper-available-height)","--reka-hover-card-trigger-width":"var(--reka-popper-anchor-width)","--reka-hover-card-trigger-height":"var(--reka-popper-anchor-height)"},onPointerdown:f[0]||(f[0]=w=>{w.currentTarget.contains(w.target)&&(c.value=!0),s(i).hasSelectionRef.value=!1,s(i).isPointerDownOnContentRef.value=!0})}),{default:g(()=>[F(p.$slots,"default")]),_:3},16,["data-state","style"])]),_:3},8,["onDismiss"]))}}),un=ln,dn=A({__name:"HoverCardContent",props:{forceMount:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(n,{emit:t}){const l=Ct(n,t),{forwardRef:r}=V(),a=ye();return(i,u)=>(P(),L(s(Bt),{present:i.forceMount||s(a).open.value},{default:g(()=>[h(un,se(s(l),{ref:s(r),onPointerenter:u[0]||(u[0]=d=>s(de)(s(a).onOpen)(d))}),{default:g(()=>[F(i.$slots,"default")]),_:3},16)]),_:3},8,["present"]))}}),Be=dn,cn=A({__name:"HoverCardPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(n){const t=n;return(e,o)=>(P(),L(s(Gt),ot(at(t)),{default:g(()=>[F(e.$slots,"default")]),_:3},16))}}),Ne=cn,fn=A({__name:"HoverCardTrigger",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"a"}},setup(n){const{forwardRef:t,currentElement:e}=V(),o=ye();o.triggerElement=e;function l(){setTimeout(()=>{!o.isPointerInTransitRef.value&&!o.open.value&&o.onClose()},0)}return(r,a)=>(P(),L(s(Yt),{"as-child":"",reference:r.reference},{default:g(()=>[h(s(ie),{ref:s(t),"as-child":r.asChild,as:r.as,"data-state":s(o).open.value?"open":"closed","data-grace-area-trigger":"",onPointerenter:a[0]||(a[0]=i=>s(de)(s(o).onOpen)(i)),onPointerleave:a[1]||(a[1]=i=>s(de)(l)(i)),onFocus:a[2]||(a[2]=i=>s(o).onOpen()),onBlur:a[3]||(a[3]=i=>s(o).onClose())},{default:g(()=>[F(r.$slots,"default")]),_:3},8,["as-child","as","data-state"])]),_:3},8,["reference"]))}}),Re=fn;const pn={class:"absolute inset-0 overflow-hidden rounded-full"},mn={class:"text-neutral-800 dark:text-white text-sm font-bold drop-shadow leading-none"},vn={class:"relative overflow-hidden p-3 space-y-3"},hn={class:"flex items-center justify-between"},yn={class:"text-sm font-semibold text-neutral-900 dark:text-white"},gn={class:"text-neutral-500 dark:text-muted text-[10px]"},bn={class:"grid grid-cols-3 gap-2 h-full"},_n={class:"absolute inset-0 bg-white/30 dark:bg-black/20 duration-300 flex justify-center items-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer pointer-events-none"},wn={class:"rounded-full bg-white/80 dark:bg-black/50 p-2 backdrop-blur-sm flex justify-center items-center"},xn={key:0,class:"absolute inset-0 bg-white/80 dark:bg-black/60 flex items-center justify-center cursor-pointer pointer-events-none"},kn={class:"text-neutral-800 dark:text-white text-lg font-bold"},Pn={class:"relative space-y-1"},Cn={key:0,class:"flex items-center gap-1 text-xs text-neutral-600 dark:text-muted font-medium mt-2"},On={class:"truncate"},Sn={key:1,class:"flex items-center gap-1 text-xs text-neutral-600 dark:text-muted font-medium mt-2"},En={class:"truncate"},Dn=A({__name:"ClusterPin",props:{clusterPoint:{},clusterCount:{default:6},markerId:{default:void 0}},emits:["click","close"],setup(n,{emit:t}){const e=n,o=t,l=Ee(),r=()=>{o("click",e.clusterPoint)},a=x(()=>e.clusterPoint.properties.clusteredPhotos||[]),i=x(()=>e.clusterPoint.properties.point_count||1),u=x(()=>e.clusterPoint.properties.marker),d=x(()=>{const c=i.value;return Math.min(64,Math.max(44,32+Math.log(c)*10))});return(c,v)=>{const b=Re,p=Se,f=me,w=Be,k=Oe,S=Ne,O=Le,z=$e;return P(),L(z,{key:`marker-cluster-${s(u).id}`,"marker-id":`marker-cluster-${n.markerId||s(u).id}`,lnglat:e.clusterPoint.geometry.coordinates},{marker:g(()=>[h(O,{"open-delay":300,"close-delay":100,onClose:v[0]||(v[0]=y=>y.preventDefault())},{default:g(()=>[h(b,{"as-child":""},{default:g(()=>[h(s(Z).div,{class:"relative group cursor-pointer",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},"while-hover":{scale:1.1},"while-press":{scale:.95},transition:{type:"spring",stiffness:400,damping:30},onClick:r},{default:g(()=>[_("div",pn,[h(oe,{src:s(u).thumbnailUrl,alt:s(u).title||`聚类 ${s(u).id}`,thumbhash:s(u).thumbnailHash,threshold:.1,"root-margin":"100px",class:"h-full w-full object-cover opacity-50"},null,8,["src","alt","thumbhash"]),v[1]||(v[1]=_("div",{class:"absolute inset-0 bg-gradient-to-br from-blue/40 to-purple/60 dark:from-blue/60 dark:to-purple/80"},null,-1))]),_("div",{class:Pe(s(Ce)("relative flex flex-col justify-center items-center rounded-full border shadow-lg hover:shadow-xl","border-white/50 bg-white/80 hover:bg-white/90 dark:border-white/30 dark:bg-black/60 dark:hover:bg-black/80")),style:pe({width:`${s(d)}px`,height:`${s(d)}px`})},[v[2]||(v[2]=_("div",{class:"absolute inset-0 rounded-full bg-gradient-to-br from-white/10 to-white/5"},null,-1)),_("span",mn,B(s(i)),1),v[3]||(v[3]=_("div",{class:"absolute inset-0 rounded-full shadow-inner shadow-black/5"},null,-1))],6)]),_:1})]),_:1}),h(S,null,{default:g(()=>[h(k,null,{default:g(()=>[h(w,{"as-child":"",side:"top",align:"center","side-offset":8},{default:g(()=>[h(s(Z).div,{class:"bg-white/50 dark:bg-black/50 backdrop-blur-md border border-neutral-100 dark:border-neutral-700 rounded-lg shadow-lg w-xs max-w-xs overflow-hidden relative",initial:{opacity:0,scale:.95,y:4},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:4},transition:{duration:.2}},{default:g(()=>[_("div",vn,[_("div",hn,[_("h3",yn,B(c.$t("map.cluster.nearbyPhotos",[s(a).length])),1),_("div",gn,B(c.$t("map.cluster.details")),1)]),_("div",bn,[(P(!0),q(re,null,le(s(a).slice(0,n.clusterCount),(y,m)=>(P(),L(s(Z).div,{key:y.id,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:m*.05,type:"spring",duration:.4,bounce:0},class:"relative overflow-hidden rounded group"},{default:g(()=>[h(p,{class:"block w-full h-full",to:`/${y.id}`,target:"_blank",rel:"noopener"},{default:g(()=>[h(oe,{src:y.thumbnailUrl,alt:y.title||`照片 ${y.id}`,thumbhash:y.thumbnailHash,threshold:.1,"root-margin":"200px",class:"w-full aspect-square object-cover"},null,8,["src","alt","thumbhash"])]),_:2},1032,["to"]),_("div",_n,[_("div",wn,[h(f,{name:"tabler:external-link",class:"text-neutral-700 dark:text-white"})])]),m===n.clusterCount-1&&s(a).length>n.clusterCount?(P(),q("div",xn,[_("span",kn," +"+B(s(a).length-n.clusterCount),1)])):T("",!0)]),_:2},1032,["transition"]))),128))]),_("div",Pn,[s(a).length&&s(a).some(y=>y.city)?(P(),q("div",Cn,[h(f,{name:"tabler:map-pin",class:"size-4"}),_("span",On,B(s(a).map(y=>y.city).filter((y,m,E)=>y&&E.indexOf(y)===m).join(", ")),1)])):T("",!0),s(a).length&&s(a).some(y=>y.dateTaken)?(P(),q("div",Sn,[h(f,{name:"tabler:calendar-week",class:"size-4"}),_("span",En,B((()=>{const y=s(a).map(m=>m.dateTaken).filter(Boolean).sort();return y.length===0?"":y.length===1?s(l)(y[0]).format("l"):`${s(l)(y[0]).format("l")} - ${s(l)(y[y.length-1]).format("l")}`})()),1)])):T("",!0)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["marker-id","lnglat"])}}}),$n=Object.assign(Dn,{__name:"MapClusterPin"}),qn={key:0,class:"bg-primary/20 dark:bg-primary/30 absolute -inset-1 animate-pulse rounded-full"},An={class:"absolute inset-0 overflow-hidden rounded-full"},Mn={class:"relative h-36 overflow-hidden"},Tn={class:"relative px-3 py-2 space-y-1"},Ln={class:"flex-1 text-lg font-semibold truncate"},Bn={class:"space-y-1"},Nn={key:0,class:"flex items-center gap-1 text-xs text-neutral-600 dark:text-muted font-medium mb-2"},Rn={key:0},In={class:"truncate"},zn={key:1},Hn={key:2},Fn={class:"truncate"},jn={key:1,class:"flex items-center gap-1 text-xs text-neutral-600 dark:text-muted"},Un={class:"truncate"},Wn={key:2,class:"flex items-center gap-1 text-xs text-neutral-600 dark:text-muted"},Gn={class:"truncate font-mono"},Kn={key:3,class:"flex items-center gap-1 text-xs text-neutral-600 dark:text-muted"},Vn={class:"truncate font-mono"},Zn=A({__name:"PhotoPin",props:{clusterPoint:{},isSelected:{type:Boolean,default:!1},markerId:{default:void 0}},emits:["click","close"],setup(n,{emit:t}){const e=n,o=t,l=Ee(),r=x(()=>e.clusterPoint.properties.marker),a=()=>{o("click",e.clusterPoint)};return(i,u)=>{const d=me,c=Re,v=De,b=Se,p=Be,f=Oe,w=Ne,k=Le,S=$e;return P(),L(S,{ref:"markerRef",key:`marker-single-${s(r).id}`,"marker-id":`marker-single-${n.markerId||s(r).id}`,lnglat:e.clusterPoint.geometry.coordinates},{marker:g(()=>[h(k,{open:n.isSelected||void 0,"open-delay":n.isSelected?0:600,"close-delay":n.isSelected?Number.MAX_SAFE_INTEGER:100,onClose:u[5]||(u[5]=O=>O.preventDefault())},{default:g(()=>[h(c,{"as-child":""},{default:g(()=>[h(s(Z).div,{class:"relative group cursor-pointer",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},"while-hover":{scale:1.1},"while-press":{scale:.95},transition:{type:"spring",stiffness:400,damping:30},onClick:a},{default:g(()=>[n.isSelected?(P(),q("div",qn)):T("",!0),_("div",An,[h(oe,{src:s(r).thumbnailUrl,alt:s(r).title||`照片 ${s(r).id}`,thumbhash:s(r).thumbnailHash,threshold:.1,"root-margin":"100px",class:"h-full w-full object-cover opacity-50"},null,8,["src","alt","thumbhash"]),u[6]||(u[6]=_("div",{class:"absolute inset-0 bg-gradient-to-br from-green/40 to-emerald/60 dark:from-green/60 dark:to-emerald/80"},null,-1))]),_("div",{class:Pe(s(Ce)("relative size-10 flex justify-center items-center rounded-full border shadow-lg hover:shadow-xl",n.isSelected?"border-primary/60 bg-primary/80 shadow-primary/30 dark:border-primary/40 dark:bg-primary/90 dark:shadow-primary/50":"border-white/50 bg-white/80 hover:bg-white/90 dark:border-white/30 dark:bg-black/80 dark:hover:bg-black/90"))},[u[7]||(u[7]=_("div",{class:"absolute inset-0 rounded-full bg-gradient-to-br from-white/10 to-white/5"},null,-1)),h(d,{name:"tabler:photo",class:"size-5 text-neutral-700 dark:text-white drop-shadow"}),u[8]||(u[8]=_("div",{class:"absolute inset-0 rounded-full shadow-inner shadow-black/5"},null,-1))],2)]),_:1})]),_:1}),h(w,null,{default:g(()=>[h(f,null,{default:g(()=>[h(p,{"as-child":"",side:"top",align:"center","side-offset":8,onPointerDownOutside:u[1]||(u[1]=O=>n.isSelected?O.preventDefault():void 0),onEscapeKeyDown:u[2]||(u[2]=O=>n.isSelected?O.preventDefault():void 0),onFocusOutside:u[3]||(u[3]=O=>n.isSelected?O.preventDefault():void 0),onInteractOutside:u[4]||(u[4]=O=>n.isSelected?O.preventDefault():void 0)},{default:g(()=>[h(s(Z).div,{class:"bg-white/50 dark:bg-black/50 backdrop-blur-md border border-neutral-100 dark:border-neutral-700 rounded-lg shadow-lg w-xs max-w-xs overflow-hidden relative",initial:{opacity:0,scale:.95,y:4},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:4},transition:{duration:.2}},{default:g(()=>[n.isSelected?(P(),L(v,{key:0,class:"absolute top-2 right-2 z-10",size:"sm",icon:"tabler:x",onClick:u[0]||(u[0]=O=>i.$emit("close"))})):T("",!0),_("div",Mn,[h(oe,{src:s(r).thumbnailUrl,alt:s(r).title||`照片 ${s(r).id}`,thumbhash:s(r).thumbnailHash,threshold:.1,"root-margin":"200px",class:"w-full h-full object-cover"},null,8,["src","alt","thumbhash"])]),_("div",Tn,[h(b,{to:`/${s(r).id}`,target:"_blank",rel:"noopener",class:"flex items-center gap-2 text-neutral-900 dark:text-white group/link"},{default:g(()=>[_("h3",Ln,B(s(r).title||`照片 ${s(r).id}`),1),h(d,{name:"tabler:external-link",class:"size-4 text-neutral-500 dark:text-muted opacity-0 group-hover/link:opacity-100 transition-opacity"})]),_:1},8,["to"]),_("div",Bn,[s(r).city||s(r).exif?.DateTimeOriginal?(P(),q("div",Nn,[s(r).city?(P(),q("div",Rn,[_("span",In,B(s(r).city),1)])):T("",!0),s(r).city?(P(),q("span",zn,"·")):T("",!0),s(r).exif?.DateTimeOriginal?(P(),q("div",Hn,[_("span",Fn,B(s(l)(s(r).exif.DateTimeOriginal).format("ll")),1)])):T("",!0)])):T("",!0),s(r).exif?.Make||s(r).exif?.Model?(P(),q("div",jn,[h(d,{name:"tabler:camera",class:"size-4"}),_("span",Un,B([s(r).exif?.Make,s(r).exif?.Model].filter(Boolean).join(" ")),1)])):T("",!0),s(r).exif?.GPSLatitude||s(r).exif?.GPSLongitude?(P(),q("div",Wn,[h(d,{name:"tabler:map-pin",class:"size-4"}),_("span",Gn,B(s(r).exif?.GPSLatitude?`${Math.abs(Number(s(r).exif?.GPSLatitude)).toFixed(4)}°${s(r).exif?.GPSLatitudeRef}`:"未知")+", "+B(s(r).exif?.GPSLongitude?`${Math.abs(Number(s(r).exif?.GPSLongitude)).toFixed(4)}°${s(r).exif?.GPSLongitudeRef}`:"未知"),1)])):T("",!0),s(r).exif?.GPSAltitude?(P(),q("div",Kn,[h(d,{name:"tabler:mountain",class:"size-4"}),_("span",Vn,B(`${s(r).exif.GPSAltitudeRef==="Below Sea Level"?"-":""}${Math.abs(Number(s(r).exif.GPSAltitude)).toFixed(1)}m`),1)])):T("",!0)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open","open-delay","close-delay"])]),_:1},8,["marker-id","lnglat"])}}}),Xn=Object.assign(Zn,{__name:"MapPhotoPin"});function Yn(n,t){if(n.length===0)return[];if(t>=15)return n.map(r=>({type:"Feature",properties:{marker:r},geometry:{type:"Point",coordinates:[r.longitude,r.latitude]}}));const e=[],o=new Set,l=Math.max(.001,.01/Math.pow(2,t-10));for(const r of n){if(o.has(r.id))continue;const a=[r];o.add(r.id);for(const i of n){if(o.has(i.id))continue;Math.sqrt(Math.pow(r.longitude-i.longitude,2)+Math.pow(r.latitude-i.latitude,2))<l&&(a.push(i),o.add(i.id))}if(a.length===1)e.push({type:"Feature",properties:{marker:r},geometry:{type:"Point",coordinates:[r.longitude,r.latitude]}});else{const i=a.reduce((d,c)=>d+c.longitude,0)/a.length,u=a.reduce((d,c)=>d+c.latitude,0)/a.length;e.push({type:"Feature",properties:{cluster:!0,point_count:a.length,point_count_abbreviated:a.length.toString(),marker:a[0],clusteredPhotos:a},geometry:{type:"Point",coordinates:[i,u]}})}}return e}function Jn(n){return n.filter(t=>t.latitude!==null&&t.longitude!==null&&t.latitude!==void 0&&t.longitude!==void 0).map(t=>({id:t.id,latitude:t.latitude,longitude:t.longitude,title:t.title||void 0,thumbnailUrl:t.thumbnailUrl||void 0,thumbnailHash:t.thumbnailHash||void 0,dateTaken:t.dateTaken||void 0,city:t.city||void 0,exif:t.exif||void 0}))}const Qn={class:"w-full h-svh relative overflow-hidden"},er={class:"absolute bottom-4 left-4 z-10 flex flex-col"},tr={class:"w-full h-full flex items-center justify-center"},sr=A({__name:"globe",setup(n){const{t}=st();it({title:t("title.globe")});const e=lt(),o=ut(),{photos:l}=dt(),r=x(()=>l.value.filter(m=>m.latitude!==null&&m.longitude!==null&&m.latitude!==void 0&&m.longitude!==void 0)),a=C(null),i=C(null),u=C(4),d=x(()=>{const m=Jn(r.value);return Yn(m,u.value)}),c=x(()=>d.value.filter(m=>m.properties.cluster===!0)),v=x(()=>d.value.filter(m=>m.properties.cluster!==!0));te(a,m=>{if(m)o.replace({query:{...e.query,photoId:m}});else{const{photoId:E,...D}=e.query;o.replace({query:{...D}})}});const b=x(()=>{if(r.value.length===0)return{longitude:-122.4,latitude:37.8,zoom:2};const m=r.value.map(Y=>Y.latitude),E=r.value.map(Y=>Y.longitude),D=Math.min(...m),I=Math.max(...m),j=Math.min(...E),U=Math.max(...E),G=(D+I)/2,M=(j+U)/2,$=I-D,K=U-j,H=Math.max($,K);let N=8;return H<.005?N=16:H<.02?N=14:H<.05?N=12:H<.2?N=10:H<1?N=8:H<5?N=6:H<20?N=5:H<50?N=4:N=2,{longitude:M,latitude:G,zoom:N}}),p=m=>{if(m.properties.cluster===!0){const E=m.properties.clusteredPhotos||[];if(E.length>0&&i.value){const D=E.map(K=>K.latitude),I=E.map(K=>K.longitude),j=Math.min(...D),U=Math.max(...D),G=Math.min(...I),M=Math.max(...I),$=.001;i.value.fitBounds([[G-$,j-$],[M+$,U+$]],{padding:50,duration:1e3})}return}if(m.properties.marker?.id===a.value){a.value=null;return}a.value=m.properties.marker?.id||null},f=()=>{a.value=null},w=m=>{i.value=m;const{photoId:E}=e.query;if(E&&typeof E=="string"){const D=r.value.find(I=>I.id===E);D&&D.latitude&&D.longitude&&setTimeout(()=>{m.flyTo({center:[D.longitude,D.latitude],zoom:17,essential:!0,duration:2e3}),setTimeout(()=>{X(()=>{a.value=E})},2e3)},600)}u.value=m.getZoom()},k=mt(()=>{i.value&&(u.value=i.value.getZoom())},100),S=()=>{i.value&&i.value.zoomIn({duration:300})},O=()=>{i.value&&i.value.zoomOut({duration:300})},z=()=>{i.value&&(a.value=null,i.value.flyTo({center:[b.value.longitude,b.value.latitude],zoom:b.value.zoom,essential:!0,duration:1e3}))},y=()=>Math.random().toString(36).substring(2,15);return ct(()=>{i.value&&(i.value.remove(),i.value=null)}),(m,E)=>{const D=De,I=$n,j=Xn,U=pt,G=me,M=ft;return P(),q("div",Qn,[h(D,{class:"absolute top-4 left-4 z-10",icon:"tabler:home",onClick:E[0]||(E[0]=$=>m.$router.push("/"))}),_("div",er,[h(D,{class:"rounded-b-none border-b-0",icon:"tabler:plus",onClick:S}),h(D,{class:"rounded-none",icon:"tabler:minus",onClick:O}),h(D,{class:"rounded-t-none border-t-0",icon:"tabler:scan-position",onClick:z})]),h(s(Z).div,{initial:{opacity:0,scale:1.08},animate:{opacity:1,scale:1},transition:{duration:.6,delay:.1},class:"w-full h-full"},{default:g(()=>[h(M,null,{fallback:g(()=>[_("div",tr,[h(G,{name:"tabler:map-pin-off",class:"size-10 text-gray-500 animate-pulse"})])]),default:g(()=>[h(U,{class:"w-full h-full","map-id":y(),zoom:s(b).zoom,center:[s(b).longitude,s(b).latitude],"attribution-control":!1,language:m.$i18n.locale,onLoad:w,onZoom:s(k)},{default:g(()=>[s(i)?(P(!0),q(re,{key:0},le(s(c),$=>(P(),L(I,{key:`cluster-${$.properties.marker?.id}`,"cluster-point":$,"marker-id":y(),onClick:p,onClose:f},null,8,["cluster-point","marker-id"]))),128)):T("",!0),s(i)?(P(!0),q(re,{key:1},le(s(v),$=>(P(),L(j,{key:`single-${$.properties.marker?.id}`,"cluster-point":$,"is-selected":$.properties.marker?.id===s(a),"marker-id":y(),onClick:p,onClose:f},null,8,["cluster-point","is-selected","marker-id"]))),128)):T("",!0)]),_:1},8,["map-id","zoom","center","language","onZoom"])]),_:1})]),_:1})])}}});export{sr as default};
